---
shortcuts:
  - type: Model
    name: campanias
    id: idCampania
    schema: campania
    url: '/ss/campanias'
    logicDelete: false
state:
  showFilter: false
  mostrarArchivadas: false
bunch:
  onInit:
    - _type: grape
      name: getCampanias
      payload:
        getCampaniasParams:
            code: 'return {archivadas: state.mostrarArchivadas, cuentamarketing: "sanhigia"}'
  onAtrasClicked:
    - _type: set
      path: campanias.current
      value:
        const: null
    - _type: navigate
      url:
        const: '/'
  onShowFilterClicked:
    - _type: set
      path: showFilter
      value:
        toggleStatePath: showFilter
  onNuevaCampaniaClicked:
    - _type: navigate
      url:
        const: /ss/campanias/nueva
  onMostrarArchivadasChanged:
    - _type: set 
      path: mostrarArchivadas
      value:
        toggleStatePath: mostrarArchivadas
  onCampaniasFilterChanged:
    - _type: if
      if:
        operator: A = B
        A:
          payloadPath: type
        B:
          const: 'clearFilter'
      then:
        _type: grape
        name: resetMostarArchivadas
      else:
        _type: grape
        name: filtroCambiado
        payload:
          mostrarArchivadas:
            code: 'return state.mostrarArchivadas'
  resetMostarArchivadas:  
    - _type: set 
      path: mostrarArchivadas
      value:
        const: false
    - _type: grape
      name: filtroCambiado
      payload:
        mostrarArchivadas:
          code: 'return false'
  filtroCambiado:
    - _type: grape
      name: onShowFilterClicked
    - _type: set
      path: campanias.filter
      value:
        payloadPath: value
    - _type: grape
      name: getCampanias
      payload:
        getCampaniasParams:
            code: 'return {archivadas: payload.mostrarArchivadas, cuentamarketing: "sanhigia"}'  
  lanzarConsultas: 
    - _type: grape
      condition:
          operator: A = B
          A:
            payloadPath: type
          B:
            const: 'clearFilter'
      name: seteaDatosAux           
    - _type: grape
      name: seteaDatosXls                         
    - _type: grape
      name: getConsultas
      payload:
        getConsultasParams:
          code: 'return {soloAceptaComunicacion: state.soloAceptaComunicacion}'       
  onCampaniasItemChanged: 
    - _type: grape
      condition:
          operator: A is true
          A:
            code: 'return !state.mostrarArchivadas && payload.item.estado === "archivada"'
      name: deleteCampaniasItem